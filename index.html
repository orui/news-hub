<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“° News Hub - æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¾ã¨ã‚ã‚µã‚¤ãƒˆ</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’è¤‡æ•°ã®ã‚½ãƒ¼ã‚¹ã‹ã‚‰è‡ªå‹•å–å¾—ã—ã¦è¡¨ç¤ºã™ã‚‹å‹•çš„ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¾ã¨ã‚ã‚µã‚¤ãƒˆ">
    <meta name="keywords" content="ãƒ‹ãƒ¥ãƒ¼ã‚¹, æœ€æ–°æƒ…å ±, ã¾ã¨ã‚, RSS, å‹•çš„æ›´æ–°">
    <meta name="author" content="News Hub">
    
    <!-- Open Graph -->
    <meta property="og:title" content="News Hub - æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ã¾ã¨ã‚ã‚µã‚¤ãƒˆ">
    <meta property="og:description" content="è¤‡æ•°ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚½ãƒ¼ã‚¹ã‹ã‚‰æœ€æ–°æƒ…å ±ã‚’è‡ªå‹•å–å¾—">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://orui.github.io/news-hub/">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ“°</text></svg>">
    
    <style>
        /* CSS Variables for Theme */
        :root {
            --primary-color: #2563eb;
            --secondary-color: #64748b;
            --accent-color: #f59e0b;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --border-color: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* Dark Mode */
        [data-theme="dark"] {
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --border-color: #334155;
        }

        /* Reset & Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-primary);
            background-color: var(--bg-primary);
            transition: all 0.3s ease;
        }

        /* Header */
        .header {
            background: var(--bg-primary);
            border-bottom: 1px solid var(--border-color);
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            text-decoration: none;
        }

        .logo-icon {
            margin-right: 0.5rem;
            font-size: 2rem;
        }

        /* Navigation */
        .nav {
            display: flex;
            gap: 2rem;
            align-items: center;
        }

        .nav-item {
            color: var(--text-secondary);
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }

        .nav-item:hover,
        .nav-item.active {
            color: var(--primary-color);
            background: var(--bg-secondary);
        }

        /* Controls */
        .controls {
            display: flex;
            gap: 1rem;
            align-items: center;
        }

        .search-box {
            position: relative;
        }

        .search-input {
            padding: 0.5rem 2.5rem 0.5rem 1rem;
            border: 1px solid var(--border-color);
            border-radius: 0.5rem;
            background: var(--bg-secondary);
            color: var(--text-primary);
            min-width: 200px;
        }

        .search-btn {
            position: absolute;
            right: 0.5rem;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1rem;
        }

        .theme-toggle {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 1.2rem;
            padding: 0.5rem;
            border-radius: 0.5rem;
            transition: all 0.2s ease;
        }

        .theme-toggle:hover {
            background: var(--bg-secondary);
        }

        /* Main Content */
        .main {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Category Filter */
        .category-filter {
            display: flex;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .category-btn {
            padding: 0.5rem 1rem;
            border: 1px solid var(--border-color);
            background: var(--bg-secondary);
            color: var(--text-secondary);
            border-radius: 2rem;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 0.9rem;
        }

        .category-btn:hover,
        .category-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* News Grid */
        .news-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        /* News Card */
        .news-card {
            background: var(--bg-primary);
            border: 1px solid var(--border-color);
            border-radius: 0.75rem;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
        }

        .news-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-2px);
        }

        .news-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-secondary);
            font-size: 3rem;
        }

        .news-content {
            padding: 1.5rem;
        }

        .news-category {
            display: inline-block;
            background: var(--accent-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 1rem;
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .news-title {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
            line-height: 1.4;
        }

        .news-title a {
            color: var(--text-primary);
            text-decoration: none;
        }

        .news-title a:hover {
            color: var(--primary-color);
        }

        .news-summary {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        .news-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .news-source {
            font-weight: 500;
        }

        .news-time {
            font-style: italic;
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            border: 3px solid var(--border-color);
            border-top: 3px solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Status Messages */
        .status-message {
            text-align: center;
            padding: 2rem;
            background: var(--bg-secondary);
            border-radius: 0.75rem;
            margin: 2rem 0;
        }

        .error-message {
            color: #dc2626;
        }

        .success-message {
            color: #059669;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                padding: 1rem;
                flex-direction: column;
                gap: 1rem;
            }

            .nav {
                gap: 1rem;
            }

            .search-input {
                min-width: 150px;
            }

            .main {
                padding: 1rem;
            }

            .news-grid {
                grid-template-columns: 1fr;
                gap: 1rem;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* Focus styles */
        button:focus,
        input:focus,
        a:focus {
            outline: 2px solid var(--primary-color);
            outline-offset: 2px;
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <a href="#" class="logo">
                <span class="logo-icon">ğŸ“°</span>
                <span>News Hub</span>
            </a>
            
            <nav class="nav">
                <a href="#" class="nav-item active" data-category="all">ã™ã¹ã¦</a>
                <a href="#" class="nav-item" data-category="business">ãƒ“ã‚¸ãƒã‚¹</a>
                <a href="#" class="nav-item" data-category="technology">ãƒ†ãƒƒã‚¯</a>
                <a href="#" class="nav-item" data-category="world">å›½éš›</a>
                <a href="#" class="nav-item" data-category="sports">ã‚¹ãƒãƒ¼ãƒ„</a>
            </nav>
            
            <div class="controls">
                <div class="search-box">
                    <input type="text" class="search-input" placeholder="ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’æ¤œç´¢..." id="searchInput">
                    <button class="search-btn" id="searchBtn" aria-label="æ¤œç´¢">ğŸ”</button>
                </div>
                <button class="theme-toggle" id="themeToggle" aria-label="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">ğŸŒ™</button>
            </div>
        </div>
    </header>

    <main class="main">
        <section class="category-filter" id="categoryFilter">
            <!-- ã‚«ãƒ†ã‚´ãƒªãƒ¼ãƒœã‚¿ãƒ³ã¯JavaScriptã§ç”Ÿæˆ -->
        </section>

        <section class="news-grid" id="newsGrid">
            <div class="loading">
                <div class="spinner"></div>
                <p>æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
            </div>
        </section>

        <div class="status-message" id="statusMessage" style="display: none;">
            <!-- ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ -->
        </div>
    </main>

    <script>
        // News Hub Application
        class NewsHub {
            constructor() {
                this.currentCategory = 'all';
                this.searchTerm = '';
                this.newsData = [];
                this.newsSources = []; // ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚½ãƒ¼ã‚¹ã¯å¾Œã§è¨­å®š
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.setupTheme();
                this.showPlaceholderNews();
            }

            setupEventListeners() {
                // Navigation
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.addEventListener('click', (e) => {
                        e.preventDefault();
                        this.selectCategory(e.target.dataset.category);
                    });
                });

                // Search
                document.getElementById('searchBtn').addEventListener('click', () => {
                    this.performSearch();
                });
                
                document.getElementById('searchInput').addEventListener('keypress', (e) => {
                    if (e.key === 'Enter') {
                        this.performSearch();
                    }
                });

                // Theme toggle
                document.getElementById('themeToggle').addEventListener('click', () => {
                    this.toggleTheme();
                });

                // Auto-refresh every 5 minutes
                setInterval(() => {
                    this.loadNews();
                }, 5 * 60 * 1000);
            }

            setupTheme() {
                const savedTheme = localStorage.getItem('newsHubTheme');
                const systemDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
                
                if (savedTheme) {
                    this.setTheme(savedTheme);
                } else if (systemDark) {
                    this.setTheme('dark');
                }

                // System theme change listener
                window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
                    if (!localStorage.getItem('newsHubTheme')) {
                        this.setTheme(e.matches ? 'dark' : 'light');
                    }
                });
            }

            setTheme(theme) {
                document.documentElement.setAttribute('data-theme', theme);
                document.getElementById('themeToggle').innerHTML = theme === 'dark' ? 'â˜€ï¸' : 'ğŸŒ™';
                localStorage.setItem('newsHubTheme', theme);
            }

            toggleTheme() {
                const current = document.documentElement.getAttribute('data-theme');
                this.setTheme(current === 'dark' ? 'light' : 'dark');
            }

            selectCategory(category) {
                this.currentCategory = category;
                
                // Update nav active state
                document.querySelectorAll('.nav-item').forEach(item => {
                    item.classList.toggle('active', item.dataset.category === category);
                });

                this.filterNews();
            }

            performSearch() {
                this.searchTerm = document.getElementById('searchInput').value.toLowerCase();
                this.filterNews();
            }

            filterNews() {
                const filtered = this.newsData.filter(news => {
                    const categoryMatch = this.currentCategory === 'all' || news.category === this.currentCategory;
                    const searchMatch = !this.searchTerm || 
                        news.title.toLowerCase().includes(this.searchTerm) ||
                        news.summary.toLowerCase().includes(this.searchTerm);
                    
                    return categoryMatch && searchMatch;
                });

                this.renderNews(filtered);
            }

            async loadNews() {
                // This method will be updated when news sources are provided
                console.log('ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—æ©Ÿèƒ½ã¯è¨­å®šå¾…ã¡ã§ã™');
                this.showStatusMessage('ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚½ãƒ¼ã‚¹ã®è¨­å®šã‚’ãŠå¾…ã¡ãã ã•ã„', 'info');
            }

            showPlaceholderNews() {
                // Placeholder news data
                const placeholderNews = [
                    {
                        title: 'ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚½ãƒ¼ã‚¹è¨­å®šå¾…ã¡',
                        summary: 'ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚½ãƒ¼ã‚¹ãŒè¨­å®šã•ã‚Œã‚‹ã¨ã€ã“ã“ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‹ãƒ¥ãƒ¼ã‚¹ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚',
                        category: 'info',
                        source: 'News Hub',
                        time: 'æº–å‚™ä¸­',
                        url: '#',
                        image: null
                    },
                    {
                        title: 'å‹•çš„ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—æ©Ÿèƒ½',
                        summary: 'RSS/APIã‹ã‚‰ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’è‡ªå‹•å–å¾—ã—ã¦ã€ã‚«ãƒ†ã‚´ãƒªåˆ¥ã«è¡¨ç¤ºã™ã‚‹æ©Ÿèƒ½ã‚’æ­è¼‰äºˆå®šã§ã™ã€‚',
                        category: 'technology',
                        source: 'ã‚·ã‚¹ãƒ†ãƒ ',
                        time: 'é–‹ç™ºä¸­',
                        url: '#',
                        image: null
                    },
                    {
                        title: 'ãƒ¢ãƒ€ãƒ³ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆ',
                        summary: 'ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³ã€ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰ã€æ¤œç´¢æ©Ÿèƒ½ã‚’å‚™ãˆãŸãƒ¢ãƒ€ãƒ³ãªãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆã§ã™ã€‚',
                        category: 'business',
                        source: 'News Hub',
                        time: 'å®Ÿè£…æ¸ˆã¿',
                        url: '#',
                        image: null
                    }
                ];

                this.newsData = placeholderNews;
                this.renderNews(placeholderNews);
            }

            renderNews(newsArray) {
                const grid = document.getElementById('newsGrid');
                
                if (newsArray.length === 0) {
                    grid.innerHTML = '<div class="status-message">è©²å½“ã™ã‚‹ãƒ‹ãƒ¥ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</div>';
                    return;
                }

                grid.innerHTML = newsArray.map(news => `
                    <article class="news-card">
                        ${news.image ? 
                            `<img src="${news.image}" alt="${news.title}" class="news-image">` :
                            `<div class="news-image">ğŸ“°</div>`
                        }
                        <div class="news-content">
                            <span class="news-category">${this.getCategoryLabel(news.category)}</span>
                            <h2 class="news-title">
                                <a href="${news.url}" target="_blank" rel="noopener noreferrer">${news.title}</a>
                            </h2>
                            <p class="news-summary">${news.summary}</p>
                            <div class="news-meta">
                                <span class="news-source">${news.source}</span>
                                <time class="news-time">${news.time}</time>
                            </div>
                        </div>
                    </article>
                `).join('');
            }

            getCategoryLabel(category) {
                const labels = {
                    'all': 'ã™ã¹ã¦',
                    'business': 'ãƒ“ã‚¸ãƒã‚¹',
                    'technology': 'ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼',
                    'world': 'å›½éš›',
                    'sports': 'ã‚¹ãƒãƒ¼ãƒ„',
                    'entertainment': 'ã‚¨ãƒ³ã‚¿ãƒ¡',
                    'info': 'æƒ…å ±'
                };
                return labels[category] || category;
            }

            showStatusMessage(message, type = 'info') {
                const statusDiv = document.getElementById('statusMessage');
                statusDiv.innerHTML = message;
                statusDiv.className = `status-message ${type}-message`;
                statusDiv.style.display = 'block';
                
                setTimeout(() => {
                    statusDiv.style.display = 'none';
                }, 5000);
            }

            // Method to update news sources (will be called when sources are provided)
            updateNewsSources(sources) {
                this.newsSources = sources;
                this.loadNews();
            }
        }

        // Initialize News Hub
        const newsHub = new NewsHub();
        
        // Global function for updating news sources
        window.updateNewsSources = (sources) => {
            newsHub.updateNewsSources(sources);
        };

        // Console message
        console.log('ğŸ“° News Hub initialized. Waiting for news sources configuration.');
    </script>

        <script>
        
    // ğŸ“° News Scraping System with Proxy
    class NewsScrapingSystem {
      constructor() {
        this.proxyEndpoint = 'https://api.allorigins.win/get'; // CORS proxy
        this.newsSources = [
          {
            name: 'Yahoo!ãƒ‹ãƒ¥ãƒ¼ã‚¹',
            url: 'https://news.yahoo.co.jp/',
            category: 'general',
            selector: '.newsFeed_item',
            titleSelector: '.newsFeed_item_title',
            linkSelector: 'a',
            timeSelector: '.newsFeed_item_date'
          },
          {
            name: 'ITmedia',
            url: 'https://www.itmedia.co.jp/',
            category: 'technology',
            selector: '.colBoxBody li',
            titleSelector: 'a',
            linkSelector: 'a',
            timeSelector: '.date'
          },
          {
            name: 'CNET Japan',
            url: 'https://japan.cnet.com/',
            category: 'technology',
            selector: '.latestList li',
            titleSelector: '.latestList_link',
            linkSelector: 'a',
            timeSelector: '.latestList_date'
          }
        ];
        this.cache = new Map();
        this.cacheTimeout = 5 * 60 * 1000; // 5åˆ†
      }

      async fetchWithProxy(url) {
        try {
          const proxyUrl = `${this.proxyEndpoint}?url=${encodeURIComponent(url)}`;
          const response = await fetch(proxyUrl);
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          const data = await response.json();
          return data.contents;
        } catch (error) {
          console.error('Proxy fetch error:', error);
          return null;
        }
      }

      parseHTML(htmlString) {
        const parser = new DOMParser();
        return parser.parseFromString(htmlString, 'text/html');
      }

      extractNewsFromSource(source, doc) {
        const articles = [];
        
        try {
          const newsItems = doc.querySelectorAll(source.selector);
          
          newsItems.forEach((item, index) => {
            if (index >= 10) return; // æœ€å¤§10ä»¶ã¾ã§
            
            const titleElement = item.querySelector(source.titleSelector);
            const linkElement = item.querySelector(source.linkSelector);
            const timeElement = item.querySelector(source.timeSelector);
            
            if (titleElement && linkElement) {
              const title = titleElement.textContent.trim();
              const link = linkElement.href || linkElement.getAttribute('href');
              const time = timeElement ? timeElement.textContent.trim() : 'æ™‚é–“ä¸æ˜';
              
              // ç›¸å¯¾URLã‚’çµ¶å¯¾URLã«å¤‰æ›
              const absoluteLink = link.startsWith('http') ? 
                link : 
                new URL(link, source.url).href;
              
              articles.push({
                title: title,
                summary: this.generateSummary(title),
                category: source.category,
                source: source.name,
                time: this.formatTime(time),
                url: absoluteLink,
                image: null
              });
            }
          });
        } catch (error) {
          console.error(`Error extracting from ${source.name}:`, error);
        }
        
        return articles;
      }

      generateSummary(title) {
        // ã‚¿ã‚¤ãƒˆãƒ«ã‹ã‚‰ç°¡æ˜“è¦ç´„ã‚’ç”Ÿæˆ
        return title.length > 50 ? 
          title.substring(0, 50) + '...' : 
          title;
      }

      formatTime(timeString) {
        // æ™‚é–“è¡¨ç¤ºã‚’çµ±ä¸€ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã«å¤‰æ›
        const now = new Date();
        
        if (timeString.includes('åˆ†å‰')) {
          const minutes = parseInt(timeString.match(/\d+/)?.[0] || '0');
          return `${minutes}åˆ†å‰`;
        } else if (timeString.includes('æ™‚é–“å‰')) {
          const hours = parseInt(timeString.match(/\d+/)?.[0] || '0');
          return `${hours}æ™‚é–“å‰`;
        } else if (timeString.includes('æ—¥å‰')) {
          const days = parseInt(timeString.match(/\d+/)?.[0] || '0');
          return `${days}æ—¥å‰`;
        } else if (timeString.match(/\d{1,2}:\d{2}/)) {
          return timeString;
        }
        
        return timeString || `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
      }

      async loadNewsFromSource(source) {
        const cacheKey = source.name;
        const cached = this.cache.get(cacheKey);
        
        // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯
        if (cached && (Date.now() - cached.timestamp < this.cacheTimeout)) {
          return cached.articles;
        }
        
        console.log(`ğŸ“° Loading news from ${source.name}...`);
        
        const htmlContent = await this.fetchWithProxy(source.url);
        if (!htmlContent) {
          return [];
        }
        
        const doc = this.parseHTML(htmlContent);
        const articles = this.extractNewsFromSource(source, doc);
        
        // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜
        this.cache.set(cacheKey, {
          articles: articles,
          timestamp: Date.now()
        });
        
        return articles;
      }

      async loadAllNews() {
        console.log('ğŸ”„ Loading news from all sources...');
        
        const allArticles = [];
        const promises = this.newsSources.map(source => this.loadNewsFromSource(source));
        
        try {
          const results = await Promise.allSettled(promises);
          
          results.forEach((result, index) => {
            if (result.status === 'fulfilled') {
              allArticles.push(...result.value);
            } else {
              console.error(`Failed to load from ${this.newsSources[index].name}:`, result.reason);
            }
          });
          
          // é‡è¤‡é™¤å»ã¨ã‚½ãƒ¼ãƒˆ
          const uniqueArticles = this.removeDuplicates(allArticles);
          const sortedArticles = this.sortByTime(uniqueArticles);
          
          console.log(`âœ… Loaded ${sortedArticles.length} articles from ${this.newsSources.length} sources`);
          return sortedArticles;
          
        } catch (error) {
          console.error('Error loading news:', error);
          return [];
        }
      }

      removeDuplicates(articles) {
        const seen = new Set();
        return articles.filter(article => {
          const key = article.title + article.source;
          if (seen.has(key)) {
            return false;
          }
          seen.add(key);
          return true;
        });
      }

      sortByTime(articles) {
        return articles.sort((a, b) => {
          // ç°¡æ˜“çš„ãªæ™‚é–“ã‚½ãƒ¼ãƒˆï¼ˆå®Ÿéš›ã®æ™‚åˆ»è§£æã¯è¤‡é›‘ï¼‰
          if (a.time.includes('åˆ†å‰') && b.time.includes('åˆ†å‰')) {
            const aMinutes = parseInt(a.time.match(/\d+/)?.[0] || '0');
            const bMinutes = parseInt(b.time.match(/\d+/)?.[0] || '0');
            return aMinutes - bMinutes;
          }
          return 0; // ãã®ä»–ã¯å…ƒã®é †åºã‚’ç¶­æŒ
        });
      }

      // æ—¥çµŒæ–°èå°‚ç”¨ã®ç‰¹åˆ¥ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆæ³¨æ„äº‹é …ä»˜ãï¼‰
      async loadNikkeiNews() {
        console.warn('âš ï¸  Nikkei scraping: Please ensure compliance with terms of service');
        
        const nikkeiSource = {
          name: 'æ—¥æœ¬çµŒæ¸ˆæ–°è',
          url: 'https://www.nikkei.com/',
          category: 'business',
          selector: '.m-miM09_item, .m-miM09-listWrap_item',
          titleSelector: '.m-miM09_titleText, .m-miM09-listWrap_title',
          linkSelector: 'a',
          timeSelector: '.m-miM09_date, .m-miM09-listWrap_date'
        };
        
        return await this.loadNewsFromSource(nikkeiSource);
      }
    }

    // News Hubã«çµ±åˆ
    if (typeof window !== 'undefined' && window.newsHub) {
      window.newsHub.scrapingSystem = new NewsScrapingSystem();
      
      // æ—¢å­˜ã®loadNews methodã‚’ç½®ãæ›ãˆ
      window.newsHub.loadNews = async function() {
        const articles = await this.scrapingSystem.loadAllNews();
        this.newsData = articles;
        this.filterNews();
        
        if (articles.length > 0) {
          this.showStatusMessage(`ğŸ“° ${articles.length}ä»¶ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å–å¾—ã—ã¾ã—ãŸ`, 'success');
        } else {
          this.showStatusMessage('ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
        }
      };
      
      // æ—¥çµŒãƒ‹ãƒ¥ãƒ¼ã‚¹å°‚ç”¨ãƒ¡ã‚½ãƒƒãƒ‰è¿½åŠ 
      window.newsHub.loadNikkeiNews = async function() {
        const articles = await this.scrapingSystem.loadNikkeiNews();
        this.newsData = [...this.newsData, ...articles];
        this.filterNews();
        
        this.showStatusMessage(`ğŸ“Š æ—¥çµŒãƒ‹ãƒ¥ãƒ¼ã‚¹ ${articles.length}ä»¶ã‚’è¿½åŠ ã—ã¾ã—ãŸ`, 'success');
      };
      
      // è‡ªå‹•èª­ã¿è¾¼ã¿é–‹å§‹
      setTimeout(() => {
        window.newsHub.loadNews();
      }, 1000);
      
      console.log('ğŸ”„ News scraping system integrated successfully');
    }
    
        </script>
        
        <script>
        
    // ğŸŒ Alternative News API Sources (Legal & Free)
    class NewsAPISystem {
      constructor() {
        this.apiSources = [
          {
            name: 'NewsAPI (Free)',
            url: 'https://newsapi.org/v2/top-headlines',
            params: {
              country: 'jp',
              apiKey: 'YOUR_API_KEY', // ç„¡æ–™ç™»éŒ²ã§å–å¾—
              pageSize: 10
            },
            category: 'general'
          },
          {
            name: 'Guardian API',
            url: 'https://content.guardianapis.com/search',
            params: {
              'api-key': 'test', // testã‚­ãƒ¼ã§ã‚‚åˆ©ç”¨å¯èƒ½
              'show-fields': 'headline,thumbnail,short-url',
              pageSize: 10
            },
            category: 'international'
          },
          {
            name: 'Reddit API (Tech News)',
            url: 'https://www.reddit.com/r/technology/.json',
            params: {
              limit: 10
            },
            category: 'technology'
          }
        ];
      }

      async loadFromAPI(source) {
        try {
          const url = new URL(source.url);
          Object.entries(source.params).forEach(([key, value]) => {
            url.searchParams.set(key, value);
          });

          const response = await fetch(url.toString());
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }

          const data = await response.json();
          return this.parseAPIResponse(data, source);
        } catch (error) {
          console.error(`Error loading from ${source.name}:`, error);
          return [];
        }
      }

      parseAPIResponse(data, source) {
        const articles = [];
        
        try {
          if (source.name === 'NewsAPI (Free)' && data.articles) {
            data.articles.forEach(article => {
              articles.push({
                title: article.title,
                summary: article.description || article.title,
                category: source.category,
                source: article.source.name,
                time: this.formatAPITime(article.publishedAt),
                url: article.url,
                image: article.urlToImage
              });
            });
          } else if (source.name === 'Guardian API' && data.response?.results) {
            data.response.results.forEach(article => {
              articles.push({
                title: article.webTitle,
                summary: article.fields?.headline || article.webTitle,
                category: source.category,
                source: 'The Guardian',
                time: this.formatAPITime(article.webPublicationDate),
                url: article.webUrl,
                image: article.fields?.thumbnail
              });
            });
          } else if (source.name.includes('Reddit') && data.data?.children) {
            data.data.children.forEach(post => {
              const postData = post.data;
              articles.push({
                title: postData.title,
                summary: postData.selftext?.substring(0, 100) + '...' || postData.title,
                category: source.category,
                source: 'Reddit',
                time: this.formatAPITime(new Date(postData.created_utc * 1000).toISOString()),
                url: `https://reddit.com${postData.permalink}`,
                image: postData.thumbnail !== 'self' ? postData.thumbnail : null
              });
            });
          }
        } catch (error) {
          console.error('Error parsing API response:', error);
        }
        
        return articles;
      }

      formatAPITime(timeString) {
        try {
          const date = new Date(timeString);
          const now = new Date();
          const diffMs = now - date;
          const diffMins = Math.floor(diffMs / 60000);
          const diffHours = Math.floor(diffMs / 3600000);
          const diffDays = Math.floor(diffMs / 86400000);
          
          if (diffMins < 60) {
            return `${diffMins}åˆ†å‰`;
          } else if (diffHours < 24) {
            return `${diffHours}æ™‚é–“å‰`;
          } else {
            return `${diffDays}æ—¥å‰`;
          }
        } catch (error) {
          return 'æ™‚é–“ä¸æ˜';
        }
      }

      async loadAllAPINews() {
        const allArticles = [];
        const promises = this.apiSources.map(source => this.loadFromAPI(source));
        
        try {
          const results = await Promise.allSettled(promises);
          
          results.forEach((result, index) => {
            if (result.status === 'fulfilled') {
              allArticles.push(...result.value);
            } else {
              console.error(`Failed to load from API ${this.apiSources[index].name}:`, result.reason);
            }
          });
          
          return allArticles;
        } catch (error) {
          console.error('Error loading API news:', error);
          return [];
        }
      }
    }

    // ä½¿ç”¨æ–¹æ³•ã®èª¬æ˜
    console.log(`
ğŸ“° News API Integration Guide:

1. NewsAPI.org (ç„¡æ–™):
   - ã‚µã‚¤ãƒ³ã‚¢ãƒƒãƒ—: https://newsapi.org/
   - ç„¡æ–™ãƒ—ãƒ©ãƒ³ã§1000ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/æ—¥
   - æ—¥æœ¬ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹å–å¾—å¯èƒ½

2. Guardian API (ç„¡æ–™):
   - å›½éš›ãƒ‹ãƒ¥ãƒ¼ã‚¹ï¼ˆè‹±èªï¼‰
   - API Keyä¸è¦ã§ãƒ†ã‚¹ãƒˆå¯èƒ½

3. Reddit API (ç„¡æ–™):
   - ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ç³»ãƒ‹ãƒ¥ãƒ¼ã‚¹
   - èªè¨¼ä¸è¦

æ¨å¥¨: NewsAPI.orgã§ç„¡æ–™API Keyã‚’å–å¾—
`);
    
        </script>
        </body>
</html>